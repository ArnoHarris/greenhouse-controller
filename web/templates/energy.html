{% extends "base.html" %}

{% block content %}
<div class="two-col-layout">

  <!-- LEFT: Energy -->
  <div class="panel energy-panel">
    <div class="panel-title">energy</div>

    <!-- Gauges: frequency | power | current | voltage -->
    <div class="gauges-row">

      <div class="gauge-wrap">
        <svg class="gauge-svg" viewBox="0 0 120 80" id="gauge-freq-svg"></svg>
        <div class="gauge-value" id="gauge-freq">â€”</div>
        <div class="gauge-label">frequency</div>
      </div>

      <div class="gauge-wrap">
        <svg class="gauge-svg" viewBox="0 0 120 80" id="gauge-power-svg"></svg>
        <div class="gauge-value" id="gauge-power">â€”</div>
        <div class="gauge-label">power</div>
      </div>

      <div class="gauge-wrap">
        <svg class="gauge-svg" viewBox="0 0 120 80" id="gauge-current-svg"></svg>
        <div class="gauge-value" id="gauge-current">â€”</div>
        <div class="gauge-label">current</div>
      </div>

      <div class="gauge-wrap">
        <svg class="gauge-svg" viewBox="0 0 120 80" id="gauge-voltage-svg"></svg>
        <div class="gauge-value" id="gauge-voltage">â€”</div>
        <div class="gauge-label">voltage</div>
      </div>

    </div>

    <!-- Power chart controls -->
    <div class="chart-controls">
      <div class="range-select-wrap">
        <span class="range-icon">ğŸ•</span>
        <select id="power-range" class="range-select" onchange="loadPowerChart()">
          <option value="1h">Last 1 hour</option>
          <option value="24h" selected>Last 24 hours</option>
          <option value="7d">Last 7 days</option>
          <option value="30d">Last 30 days</option>
        </select>
        <span class="range-arrow">â–¼</span>
      </div>
      <div class="date-nav">
        <button class="date-nav-btn" onclick="shiftPowerRange(-1)">â€¹</button>
        <span class="date-nav-label" id="power-date-label">â€”</span>
        <button class="date-nav-btn" onclick="shiftPowerRange(+1)">â€º</button>
      </div>
    </div>

    <div class="chart-wrap">
      <canvas id="power-chart"></canvas>
    </div>

  </div><!-- /energy-panel -->

  <!-- RIGHT: Controls (shared) -->
  {% include "partials/controls.html" %}

</div>
{% endblock %}

{% block page_script %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
<script>
  initEnergyPage();
  startDashboardPolling();
</script>
{% endblock %}
